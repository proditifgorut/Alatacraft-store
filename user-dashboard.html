<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard User - Nusantara Eceng</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top navbar-custom">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="/">
                <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=80&h=80&fit=crop&crop=center" alt="Nusantara Eceng Logo" class="logo-img me-2">
                <span class="brand-text">Nusantara Eceng</span>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Beranda</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/user-dashboard.html">Dashboard</a>
                    </li>
                </ul>
                
                <div class="d-flex align-items-center gap-2">
                    <div class="dropdown">
                        <button class="btn btn-primary btn-sm dropdown-toggle" data-bs-toggle="dropdown">
                            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=32&h=32&fit=crop&crop=face" alt="User" class="rounded-circle me-2" width="24" height="24">
                            Ahmad Rizki
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profil</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Pengaturan</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-5 pt-5">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-3 mb-4">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=120&h=120&fit=crop&crop=face" alt="Profile" class="rounded-circle mb-3" width="80" height="80">
                        <h5 class="card-title">Ahmad Rizki</h5>
                        <p class="card-text text-muted">Member sejak Jan 2024</p>
                        <span class="badge bg-success">Pelanggan Setia</span>
                    </div>
                </div>
                
                <div class="card border-0 shadow-sm mt-3">
                    <div class="list-group list-group-flush">
                        <a href="#" class="list-group-item list-group-item-action active" data-section="overview">
                            <i class="bi bi-grid-1x2 me-2"></i>Overview
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" data-section="orders">
                            <i class="bi bi-receipt me-2"></i>Pesanan Saya
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" data-section="wishlist">
                            <i class="bi bi-heart me-2"></i>Wishlist
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" data-section="address">
                            <i class="bi bi-geo-alt me-2"></i>Alamat
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" data-section="profile">
                            <i class="bi bi-person me-2"></i>Profil
                        </a>
                    </div>
                </div>
            </div>

            <!-- Content -->
            <div class="col-lg-9">
                <!-- Overview Section -->
                <div id="overview-section" class="content-section">
                    <h4 class="mb-4">Dashboard Overview</h4>
                    
                    <div class="row g-4 mb-4">
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm text-center">
                                <div class="card-body">
                                    <div class="text-primary mb-2">
                                        <i class="bi bi-cart-check display-6"></i>
                                    </div>
                                    <h5 class="card-title">12</h5>
                                    <p class="card-text text-muted">Total Pesanan</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm text-center">
                                <div class="card-body">
                                    <div class="text-success mb-2">
                                        <i class="bi bi-currency-dollar display-6"></i>
                                    </div>
                                    <h5 class="card-title">Rp 1,8M</h5>
                                    <p class="card-text text-muted">Total Belanja</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm text-center">
                                <div class="card-body">
                                    <div class="text-warning mb-2">
                                        <i class="bi bi-heart display-6"></i>
                                    </div>
                                    <h5 class="card-title">8</h5>
                                    <p class="card-text text-muted">Wishlist</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card border-0 shadow-sm text-center">
                                <div class="card-body">
                                    <div class="text-info mb-2">
                                        <i class="bi bi-star display-6"></i>
                                    </div>
                                    <h5 class="card-title">4.8</h5>
                                    <p class="card-text text-muted">Rating Review</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Orders -->
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">Pesanan Terbaru</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex align-items-center border-bottom pb-3 mb-3">
                                <img src="https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=60&h=60&fit=crop" alt="Product" class="rounded me-3">
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">Tas Anyam Premium</h6>
                                    <p class="text-muted mb-1 small">Order #ORD-001 • 15 Jan 2025</p>
                                    <span class="badge bg-warning">Pending</span>
                                </div>
                                <div class="text-end">
                                    <div class="fw-semibold">Rp 150.000</div>
                                    <button class="btn btn-outline-primary btn-sm">Detail</button>
                                </div>
                            </div>
                            
                            <div class="d-flex align-items-center border-bottom pb-3 mb-3">
                                <img src="https://images.unsplash.com/photo-1529958030586-3aae4ca485ff?w=60&h=60&fit=crop" alt="Product" class="rounded me-3">
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">Topi Anyam Tradisional</h6>
                                    <p class="text-muted mb-1 small">Order #ORD-002 • 12 Jan 2025</p>
                                    <span class="badge bg-success">Selesai</span>
                                </div>
                                <div class="text-end">
                                    <div class="fw-semibold">Rp 75.000</div>
                                    <button class="btn btn-outline-primary btn-sm">Review</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Orders Section -->
                <div id="orders-section" class="content-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4 class="mb-0">Pesanan Saya</h4>
                        <select class="form-select" style="width: auto;">
                            <option>Semua Status</option>
                            <option>Pending</option>
                            <option>Diproses</option>
                            <option>Dikirim</option>
                            <option>Selesai</option>
                        </select>
                    </div>
                    
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <div id="ordersContainer">
                                <!-- Orders will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Wishlist Section -->
                <div id="wishlist-section" class="content-section" style="display: none;">
                    <h4 class="mb-4">Wishlist Saya</h4>
                    
                    <div class="row g-4" id="wishlistContainer">
                        <!-- Wishlist items will be populated here -->
                    </div>
                </div>

                <!-- Address Section -->
                <div id="address-section" class="content-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4 class="mb-0">Alamat Saya</h4>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addAddressModal">
                            <i class="bi bi-plus-lg me-2"></i>Tambah Alamat
                        </button>
                    </div>
                    
                    <div class="row g-4" id="addressContainer">
                        <!-- Addresses will be populated here -->
                    </div>
                </div>

                <!-- Profile Section -->
                <div id="profile-section" class="content-section" style="display: none;">
                    <h4 class="mb-4">Profil Saya</h4>
                    
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <form id="profileForm">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="firstName" class="form-label">Nama Depan</label>
                                        <input type="text" class="form-control" id="firstName" value="Ahmad">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="lastName" class="form-label">Nama Belakang</label>
                                        <input type="text" class="form-control" id="lastName" value="Rizki">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="email" class="form-label">Email</label>
                                        <input type="email" class="form-control" id="email" value="ahmad.rizki@email.com">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="phone" class="form-label">Nomor Telepon</label>
                                        <input type="tel" class="form-control" id="phone" value="+62 812-3456-7890">
                                    </div>
                                    <div class="col-12">
                                        <label for="birthDate" class="form-label">Tanggal Lahir</label>
                                        <input type="date" class="form-control" id="birthDate" value="1990-01-15">
                                    </div>
                                    <div class="col-12">
                                        <button type="submit" class="btn btn-primary">Simpan Perubahan</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Address Modal -->
    <div class="modal fade" id="addAddressModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Tambah Alamat Baru</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addAddressForm">
                        <div class="mb-3">
                            <label for="addressLabel" class="form-label">Label Alamat</label>
                            <input type="text" class="form-control" id="addressLabel" placeholder="Rumah, Kantor, dll">
                        </div>
                        <div class="mb-3">
                            <label for="recipientName" class="form-label">Nama Penerima</label>
                            <input type="text" class="form-control" id="recipientName">
                        </div>
                        <div class="mb-3">
                            <label for="recipientPhone" class="form-label">Nomor Telepon</label>
                            <input type="tel" class="form-control" id="recipientPhone">
                        </div>
                        <div class="mb-3">
                            <label for="fullAddress" class="form-label">Alamat Lengkap</label>
                            <textarea class="form-control" id="fullAddress" rows="3"></textarea>
                        </div>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="city" class="form-label">Kota</label>
                                <input type="text" class="form-control" id="city">
                            </div>
                            <div class="col-md-6">
                                <label for="postalCode" class="form-label">Kode Pos</label>
                                <input type="text" class="form-control" id="postalCode">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" onclick="addAddress()">Simpan Alamat</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        class UserDashboard {
            constructor() {
                this.setupNavigation();
                this.loadUserData();
            }

            setupNavigation() {
                document.querySelectorAll('.list-group-item-action').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        
                        // Update active state
                        document.querySelectorAll('.list-group-item-action').forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                        
                        // Show section
                        const section = link.dataset.section;
                        this.showSection(section);
                    });
                });
            }

            showSection(sectionName) {
                // Hide all sections
                document.querySelectorAll('.content-section').forEach(section => {
                    section.style.display = 'none';
                });
                
                // Show selected section
                const section = document.getElementById(`${sectionName}-section`);
                if (section) {
                    section.style.display = 'block';
                }
                
                // Load section-specific data
                switch(sectionName) {
                    case 'orders':
                        this.loadOrders();
                        break;
                    case 'wishlist':
                        this.loadWishlist();
                        break;
                    case 'address':
                        this.loadAddresses();
                        break;
                }
            }

            loadUserData() {
                // Load initial data
                this.loadOrders();
                this.loadWishlist();
                this.loadAddresses();
            }

            loadOrders() {
                const orders = [
                    {
                        id: 'ORD-001',
                        product: 'Tas Anyam Premium',
                        image: 'https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=60&h=60&fit=crop',
                        price: 150000,
                        status: 'Pending',
                        date: '15 Jan 2025'
                    },
                    {
                        id: 'ORD-002',
                        product: 'Topi Anyam Tradisional',
                        image: 'https://images.unsplash.com/photo-1529958030586-3aae4ca485ff?w=60&h=60&fit=crop',
                        price: 75000,
                        status: 'Selesai',
                        date: '12 Jan 2025'
                    },
                    {
                        id: 'ORD-003',
                        product: 'Keranjang Serbaguna',
                        image: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=60&h=60&fit=crop',
                        price: 120000,
                        status: 'Dikirim',
                        date: '10 Jan 2025'
                    }
                ];

                const container = document.getElementById('ordersContainer');
                container.innerHTML = orders.map(order => `
                    <div class="d-flex align-items-center border-bottom pb-3 mb-3">
                        <img src="${order.image}" alt="${order.product}" class="rounded me-3" width="60" height="60">
                        <div class="flex-grow-1">
                            <h6 class="mb-1">${order.product}</h6>
                            <p class="text-muted mb-1 small">Order #${order.id} • ${order.date}</p>
                            <span class="badge ${this.getStatusClass(order.status)}">${order.status}</span>
                        </div>
                        <div class="text-end">
                            <div class="fw-semibold mb-2">Rp ${order.price.toLocaleString('id-ID')}</div>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary" onclick="viewOrderDetail('${order.id}')">Detail</button>
                                ${order.status === 'Selesai' ? '<button class="btn btn-outline-success">Review</button>' : ''}
                                <button class="btn btn-outline-secondary" onclick="printReceipt('${order.id}')">
                                    <i class="bi bi-printer"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            loadWishlist() {
                const wishlist = [
                    {
                        id: 1,
                        name: 'Vas Dekorasi Modern',
                        image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=300&h=300&fit=crop',
                        price: 200000,
                        artisan: 'Ibu Maya - Bali'
                    },
                    {
                        id: 2,
                        name: 'Tempat Tissue Anyam',
                        image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=300&h=300&fit=crop',
                        price: 85000,
                        artisan: 'Pak Joko - Yogyakarta'
                    }
                ];

                const container = document.getElementById('wishlistContainer');
                container.innerHTML = wishlist.map(item => `
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm">
                            <img src="${item.image}" class="card-img-top" alt="${item.name}" style="height: 200px; object-fit: cover;">
                            <div class="card-body">
                                <h5 class="card-title">${item.name}</h5>
                                <p class="card-text text-muted small">${item.artisan}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="h5 text-success mb-0">Rp ${item.price.toLocaleString('id-ID')}</span>
                                    <div class="btn-group btn-group-sm">
                                        <button class="btn btn-primary" onclick="addToCart(${item.id})">
                                            <i class="bi bi-cart-plus"></i>
                                        </button>
                                        <button class="btn btn-outline-danger" onclick="removeFromWishlist(${item.id})">
                                            <i class="bi bi-heart-fill"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            loadAddresses() {
                const addresses = [
                    {
                        id: 1,
                        label: 'Rumah',
                        name: 'Ahmad Rizki',
                        phone: '+62 812-3456-7890',
                        address: 'Jl. Sudirman No. 123, RT 02/RW 05, Kelurahan Menteng',
                        city: 'Jakarta Pusat',
                        postalCode: '10310',
                        isDefault: true
                    },
                    {
                        id: 2,
                        label: 'Kantor',
                        name: 'Ahmad Rizki',
                        phone: '+62 812-3456-7890',
                        address: 'Jl. Thamrin No. 456, Lantai 10',
                        city: 'Jakarta Pusat',
                        postalCode: '10230',
                        isDefault: false
                    }
                ];

                const container = document.getElementById('addressContainer');
                container.innerHTML = addresses.map(addr => `
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm ${addr.isDefault ? 'border-success' : ''}">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h6 class="card-title">${addr.label}</h6>
                                    ${addr.isDefault ? '<span class="badge bg-success">Default</span>' : ''}
                                </div>
                                <p class="card-text">
                                    <strong>${addr.name}</strong><br>
                                    ${addr.phone}<br>
                                    ${addr.address}<br>
                                    ${addr.city} ${addr.postalCode}
                                </p>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-outline-primary btn-sm">Edit</button>
                                    <button class="btn btn-outline-danger btn-sm">Hapus</button>
                                    ${!addr.isDefault ? '<button class="btn btn-outline-success btn-sm">Jadikan Default</button>' : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            getStatusClass(status) {
                const statusClasses = {
                    'Pending': 'bg-warning',
                    'Diproses': 'bg-info',
                    'Dikirim': 'bg-primary',
                    'Selesai': 'bg-success'
                };
                return statusClasses[status] || 'bg-secondary';
            }
        }

        // Initialize user dashboard
        document.addEventListener('DOMContentLoaded', () => {
            new UserDashboard();
        });

        // Global functions
        function viewOrderDetail(orderId) {
            window.open(`/checkout.html?order=${orderId}`, '_blank');
        }

        function printReceipt(orderId) {
            window.open(`/receipt.html?order=${orderId}`, '_blank');
        }

        function addToCart(itemId) {
            alert('Produk berhasil ditambahkan ke keranjang!');
        }

        function removeFromWishlist(itemId) {
            if (confirm('Hapus dari wishlist?')) {
                alert('Produk dihapus dari wishlist!');
                // Reload wishlist
                const dashboard = new UserDashboard();
                dashboard.loadWishlist();
            }
        }

        function addAddress() {
            const form = document.getElementById('addAddressForm');
            if (form.checkValidity()) {
                alert('Alamat berhasil ditambahkan!');
                const modal = bootstrap.Modal.getInstance(document.getElementById('addAddressModal'));
                modal.hide();
                form.reset();
                // Reload addresses
                const dashboard = new UserDashboard();
                dashboard.loadAddresses();
            }
        }
    </script>
</body>
</html>
